<link rel="stylesheet" href="/codemirror.css">
<link rel="stylesheet" href="/dracula.css">
<div class="wrapper">
  <div ref:code></div>
</div>

<script>
  import CodeMirror from 'codemirror'
  import 'codemirror/mode/yaml/yaml.js'

  export default {
    onrender () {
      this.cm = CodeMirror(this.refs.code, {
        value: this.get('yaml'),
        mode: 'yaml'
      })
      this.cm.setOption("theme", "dracula");
      this.cm.on('changes', () => {
        const yaml = this.cm.doc.getValue()
        this.set({yaml})
      })
      this.observe('yaml', yaml => {
        if (yaml != this.cm.doc.getValue()) {
          this.cm.doc.setValue(yaml)
        }
      })
    },

    data () {
      return {
        yaml: '',
      };
    },

    methods: {
      getCodeMirror () {
        return this.cm
      }
    }
  };
</script>

<style>
  .wrapper {
    padding: 0.25em;
    border-radius: 0.25em;
    background-color: var(--c-focus);
  }
</style>
